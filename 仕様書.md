# 匿名掲示板Webサイト 機能要件仕様書

| 項目   | 内容               |
| ---- | ---------------- |
| 文書番号 | BB-REQ-001       |
| 版数   | 1.0              |
| 作成日  | 2025‑05‑02       |
| 作成者  | ChatGPT (OpenAI) |

---

## 1. 目的

本書は、会員登録を必要とせず匿名で利用可能な掲示板Webサイト（以下「本システム」）の機能要件を明確化し、システム開発・テスト・運用の共通指針を提供することを目的とする。

## 2. スコープ

* 5ch 互換の利用体験を目指すが、版権や既存仕様に依存しない独自実装とする。
* サーバ―サイド／クライアントサイド（Webブラウザ）で実現する機能のみを対象とし、ネイティブアプリや外部ツールは範囲外とする。

## 3. 用語定義

| 用語           | 定義                               |
| ------------ | -------------------------------- |
| 板（Board）     | トピックごとに設けられた掲示板のカテゴリ             |
| スレッド（Thread） | 板内でユーザーが作成する投稿集合                 |
| レス（Post）     | スレッド内の書き込み 1 件                   |
| 管理者（Admin）   | 全体を統括し設定変更・削除を行う権限を持つユーザー        |
| モデレーター（Mod）  | 板単位またはスレッド単位で削除等を行える権限           |
| ID           | 投稿者を識別する英数字列（掲示板仕様に準拠した日替わりハッシュ） |
| トリップ         | 投稿者が任意に設定できる簡易署名（#pass 形式）       |

## 4. 機能要件

### FR‑01: トップページ表示

* 全板一覧をカテゴリー別に表示する。
* 板ごとに最新スレッド件数、最新書き込み時刻を併記する。

### FR‑02: 板（Board）機能

1. 板一覧取得・表示
2. 板作成（Admin のみ）
3. 板設定編集（タイトル、説明、投稿制限）
4. 板削除・非公開化（Admin のみ）

### FR‑03: スレッド機能

1. スレッド一覧表示（新着順／人気順／更新順）
2. スレッド作成（匿名ユーザー）

   * 必須項目: タイトル、本文
   * 任意項目: 名前、E-mail、トリップ、画像添付(最大5MB/枚、拡張子 jpg/png/gif/webp)
3. スレッド最大レス数上限（例: 1000 件）を超えた場合の自動クローズ
4. スレッドの自動アーカイブ・DAT 生成

### FR‑04: 投稿（レス）機能

1. 投稿フォーム

   * 名前欄（空欄時は「名無しさん」表示）
   * E-mail欄（sage 対応）
   * 本文（Markdown ライクな装飾と引用 > 表記）
   * 画像添付（板設定で許可時）
2. 投稿内容バリデーション（文字数上限、禁止ワードフィルタ）
3. 投稿成功時、即時にスレッド末尾へ表示し、レス番を採番
4. 二重投稿防止（タイムスタンプ＋ハッシュ）

### FR‑05: 表示・閲覧機能

1. スレッドビュー

   * レス番表示、ID 表示、投稿日時（JST）
   * アンカーリンク（>>123）で対象レスへスクロール
   * 画像サムネイル展開
2. 板ビュー

   * スレッドタイトル、レス数、最後の更新時刻を表示
3. ページング／無限スクロール切替
4. レスポンス取得 API (JSON) によるクライアントサイド描画

### FR‑06: 検索機能

* キーワードによる板横断検索 / 板内検索 / スレッド内検索
* AND/OR 演算子、投稿日範囲、ID フィルタリング

### FR‑07: ID／トリップ機能

* 投稿者 ID は「日付＋IP ハッシュ＋板シード」を元に24時間ごとに変化
* トリップ文字列は DES ハッシュ方式 (#key) で生成し本文に表示

### FR‑08: 通報・削除依頼

* 任意ユーザーが投稿単位で「荒らし／誹謗中傷／著作権侵害」を通報
* 通報は管理画面にキューされる
* 管理者・モデレーターは対応状況（保留／削除／無効）を設定可能

### FR‑09: 管理者・モデレーション機能

1. ダッシュボード（統計・最近の通報一覧）
2. 投稿／スレッド削除（物理削除／論理削除）
3. 規制リスト編集（CIDR/IP、UA、キーワード）
4. 投稿制限（読み書き禁止、強制 ID 表示）
5. ログ閲覧・エクスポート（CSV/JSON）

### FR‑10: Spam／荒らし対策

* reCAPTCHA v3 または hCaptcha による Bot 検出
* 投稿間隔制限（同一 IP からの連投制御）
* NG ワード・正規表現フィルタ
* URL 数上限、画像連投制限

### FR‑11: クッキー・ローカルストレージ

* ユーザー設定保存（表示テーマ、NG ID、フォントサイズ）
* 最近開いたスレッド履歴

### FR‑12: 性能・スケーラビリティ要件

* 同時接続 10,000 ユーザーで応答時間 P95  < 500 ms
* 水平スケール可能な RESTful API & キャッシュ設計

### FR‑13: セキュリティ要件

* HTTPS/TLS1.3 強制
* XSS/CSRF 対策（CSP, SameSite Cookie）
* 投稿データの永続化時にサニタイズ
* 管理画面 2 要素認証

### FR‑14: バックアップ／リカバリ

* 投稿・ログを 10 分毎にインクリメンタルバックアップ
* 24 時間毎にフルバックアップを S3 互換ストレージへ転送

### FR‑15: 国際化・ローカライゼーション

* UI 文字列を i18n ファイルで管理（初期は日本語のみ）

### FR‑16: モバイル対応

* モバイルファースト design (レスポンシブ)
* スワイプで次ページ/前ページ

### FR‑17: アクセシビリティ

* WAI‑ARIA ロール付与
* コントラスト比 4.5:1 以上

### FR‑18: API 提供（任意実装）

* 読み取り専用の公開 API (OpenAPI 定義)
* 投稿 API は認証済みクライアントへ限定

## 5. 非機能要件

| 区分 | 要件                                        |
| -- | ----------------------------------------- |
| 運用 | 稼働率 99.5%/月以上、24時間監視                      |
| 保守 | コードベースは OSS ライセンスに準拠し、Pull Request ベースで改修 |
| 法務 | プライバシーポリシー・利用規約を必ず掲示し、電気通信事業届出を行う         |

## 6. 制約

* 日本国法を遵守し、特にプロバイダ責任制限法に基づく開示請求フローを整備すること。
* 未成年ユーザーの閲覧を想定し、成人向けコンテンツ区分を導入すること。

## 7. 参考資料

* RFC 3986 (URI)
* W3C HTML Living Standard
* OWASP ASVS v4
* 総務省「インターネット上の誹謗中傷への対応に関するガイドライン」

---

*End of Document*
